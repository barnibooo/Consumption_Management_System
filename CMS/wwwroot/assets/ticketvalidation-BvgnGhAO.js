import{d as z,r,j as e,e as l,C as T,T as i,n as b,f as B}from"./index-DW2RJM_L.js";import{I as S,A as F,p,N as D}from"./Navbar-BavKYrQN.js";import{S as E,f as M}from"./format-DZSxbElR.js";import{c as N}from"./AuthService-4k0KJGyh.js";import{r as R}from"./RefreshService-CkshRjuf.js";import{T as f}from"./ThemeProvider-BqDNcuYG.js";import{A as g,S as H}from"./Snackbar-BoVZBEip.js";import{T as V}from"./TextField-B_SISyHb.js";import{C as W}from"./Card-B3esABxY.js";import{C as $}from"./CardHeader-D3kGs5sr.js";import{C as L}from"./CardMedia-Datqsumh.js";import{C as U}from"./CardContent-BSubk8B7.js";import{C as J}from"./CardActions-CR4ggJcr.js";import"./Select-CssrkscS.js";const u=z({palette:{mode:"dark"}}),K=t=>{const d=new Date(t);return M(d,"yyyy-MM-dd HH:mm")};function O(){const[t,d]=r.useState(null),[j,c]=r.useState(!1),[n,s]=r.useState(null),[h,k]=r.useState(""),[A,y]=r.useState(!1),[C,v]=r.useState(!1),[x,I]=r.useState(!1);if(r.useEffect(()=>{(async()=>{const a=localStorage.getItem("token");if(!a){console.error("No token found. Redirecting to login..."),window.location.href="/login";return}const m=p(a);if(!m||m.role!=="Admin"&&m.role!=="TicketAssistant"){I(!0);return}if(!A){if(!await N()){console.error("Invalid token. Redirecting to login..."),window.location.href="/login";return}C||(await R(),v(!0)),y(!0)}})()},[]),x)return localStorage.setItem("isUnauthorizedRedirect","true"),setTimeout(()=>{window.location.href="/"},0);r.useEffect(()=>{(async()=>{})()},[]);const w=()=>{c(!0);const o=localStorage.getItem("token");b.get(`https://localhost:5000/api/Customers/${h}`,{headers:{Authorization:`Bearer ${o}`}}).then(a=>{d(a.data),c(!1)}).catch(a=>{a.response&&a.response.status===404?s("A megadott kártyaazonosító nem található!"):a.response&&a.response.status===401?s("Az oldal használatához magasabb jogosultság szükséges!"):s(a.message),c(!1)})};return x?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(f,{theme:u,children:e.jsx(g,{severity:"warning",children:"Az oldal használatához magasabb jogosultság szükséges!"})})}):j?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(T,{size:120,sx:{color:"#bfa181"}})}):e.jsxs(l,{sx:{display:"flex",flexDirection:"column",height:"100vh",padding:2,alignItems:"center"},children:[e.jsxs(l,{sx:{width:"100%",display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(V,{sx:{width:"30%",height:"Auto","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#d5d6d6"},"&:hover fieldset":{borderColor:"#d5d6d6"},"&.Mui-focused fieldset":{borderColor:"#BFA181"}},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInputLabel-root.Mui-focused":{color:"#BFA181"},"& .MuiInputBase-input":{color:"#d5d6d6",caretColor:"#d5d6d6"},marginBottom:2},required:!0,id:"outlined-search",label:"Kártyaazonosító",type:"search",margin:"dense",value:h,onChange:o=>{k(o.target.value),d(null)}}),e.jsx(S,{sx:{fontSize:40,color:"#d5d6d6","&:hover":{color:"#BFA181"},"&:active":{color:"#BFA181"}},"aria-label":"add to shopping cart",onClick:w,children:e.jsx(E,{fontSize:"inherit"})})]}),n&&e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(H,{open:!!n,autoHideDuration:6e3,onClose:()=>{n==="A megadott kártyaazonosító nem található!"?(s(null),window.location.reload()):n==="Network Error"&&(s(null),window.location.href="/")},children:e.jsx(g,{onClose:()=>{console.log(n),n==="A megadott kártyaazonosító nem található!"?(s(null),window.location.reload()):n==="Network Error"&&(s(null),window.location.href="/")},severity:"error",variant:"filled",sx:{width:"100%"},children:n==="A megadott kártyaazonosító nem található!"?"A megadott kártyaazonosító nem található!":"Hiba történt az adatok betöltése közben!"})})}),t&&e.jsx(f,{theme:u,children:e.jsxs(W,{sx:{bgcolor:"#202938",color:"#d5d6d6",width:{xs:"100%",sm:"70%",md:"60%",lg:"50%",xl:"40%"},marginTop:2},children:[e.jsx($,{avatar:e.jsx(F,{sx:{bgcolor:"#BFA181",color:"#d5d6d6"},"aria-label":"recipe"}),title:e.jsxs(i,{variant:"h5",sx:{color:"#d5d6d6"},children:[t==null?void 0:t.name," #",t==null?void 0:t.customerId]}),subheader:e.jsx(i,{variant:"subtitle1",sx:{color:"#d5d6d6"},children:"Adatok"})}),e.jsx(L,{component:"img",height:"194",image:"/img/profile/profile_temp.png"}),e.jsxs(U,{children:[e.jsx(i,{variant:"h4",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:400,textAlign:"left"},children:t?`Hello ${t==null?void 0:t.name}!`:""}),e.jsx(i,{variant:"h6",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:300,textAlign:"left"},children:t?`Belépés ideje: ${K(t.createdAt)}`:""}),e.jsx(i,{variant:"h6",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:300,textAlign:"left"},children:t?t.tickets.map(o=>e.jsxs("div",{children:["Jegy: ",o.ticketName]},o.ticketId)):"N/A"}),e.jsxs(i,{variant:"h6",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:300,textAlign:"left"},children:["Kiegészítő jegy(ek):",t?t.admissions.map(o=>e.jsx("li",{children:o.admissionName},o.admissionId)):"N/A"]})]}),e.jsx(J,{})]})})]})}const P=p(localStorage.getItem("token")).role;B.createRoot(document.getElementById("root")).render(e.jsxs(e.Fragment,{children:[e.jsx(D,{role:P}),e.jsx(O,{})]}));
