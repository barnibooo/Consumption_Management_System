import{d as z,r as s,j as e,e as d,C as T,T as l,n as b,f as B}from"./index-DW2RJM_L.js";import{I as S,A as F,p,N as M}from"./Navbar-BavKYrQN.js";import{S as N,f as E}from"./format-DZSxbElR.js";import{c as R}from"./AuthService-CMdpMXi0.js";import{r as D}from"./RefreshService-BElCRExB.js";import{T as g}from"./ThemeProvider-BqDNcuYG.js";import{A as f,S as H}from"./Snackbar-BoVZBEip.js";import{T as V}from"./TextField-B_SISyHb.js";import{C as W}from"./Card-B3esABxY.js";import{C as $}from"./CardHeader-D3kGs5sr.js";import{C as L}from"./CardMedia-Datqsumh.js";import{C as U}from"./CardContent-BSubk8B7.js";import{C as J}from"./CardActions-CR4ggJcr.js";import"./Select-CssrkscS.js";const u=z({palette:{mode:"dark"}}),K=t=>{const c=new Date(t);return E(c,"yyyy-MM-dd HH:mm")};function O(){const[t,c]=s.useState(null),[j,m]=s.useState(!1),[r,n]=s.useState(null),[i,k]=s.useState(""),[y,A]=s.useState(!1),[C,I]=s.useState(!1),[x,v]=s.useState(!1);if(s.useEffect(()=>{(async()=>{const a=localStorage.getItem("token");if(!a){console.error("No token found. Redirecting to login..."),window.location.href="/login";return}const h=p(a);if(!h||h.role!=="Admin"&&h.role!=="TicketAssistant"){v(!0);return}if(!y){if(!await R()){console.error("Invalid token. Redirecting to login..."),window.location.href="/login";return}C||(await D(),I(!0)),A(!0)}})()},[]),x)return localStorage.setItem("isUnauthorizedRedirect","true"),setTimeout(()=>{window.location.href="/"},0);const w=()=>{m(!0);const o=localStorage.getItem("token");b.get(`https://localhost:5000/api/Customers/${i}`,{headers:{Authorization:`Bearer ${o}`}}).then(a=>{c(a.data),m(!1)}).catch(a=>{a.response&&a.response.status===404?n("A megadott kártyaazonosító nem található!"):a.response&&a.response.status===401?n("Az oldal használatához magasabb jogosultság szükséges!"):n(a.message),m(!1)})};return x?e.jsx(d,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(g,{theme:u,children:e.jsx(f,{severity:"warning",children:"Az oldal használatához magasabb jogosultság szükséges vagy a kapcsolat megszakadt!"})})}):j?e.jsx(d,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(T,{size:120,sx:{color:"#bfa181"}})}):e.jsxs(d,{sx:{display:"flex",flexDirection:"column",height:"100vh",padding:2,alignItems:"center"},children:[e.jsxs(d,{sx:{width:"100%",display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(V,{sx:{width:"30%",height:"Auto","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#d5d6d6"},"&:hover fieldset":{borderColor:"#d5d6d6"},"&.Mui-focused fieldset":{borderColor:"#BFA181"}},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInputLabel-root.Mui-focused":{color:"#BFA181"},"& .MuiInputBase-input":{color:"#d5d6d6",caretColor:"#d5d6d6"},marginBottom:2},required:!0,id:"outlined-search",label:"Kártyaazonosító",type:"search",margin:"dense",value:i,onChange:o=>{k(o.target.value),c(null)}}),e.jsx(S,{sx:{fontSize:40,color:i?"#d5d6d6":"#565656","&:hover":{color:i?"#BFA181":"#565656"},"&:active":{color:i?"#BFA181":"#565656"}},onClick:w,disabled:!i,children:e.jsx(N,{fontSize:"inherit"})})]}),r&&e.jsx(d,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(H,{open:!!r,autoHideDuration:6e3,onClose:()=>{r==="A megadott kártyaazonosító nem található!"?(n(null),window.location.reload()):r==="Network Error"&&(n(null),window.location.href="/")},children:e.jsx(f,{onClose:()=>{console.log(r),r==="A megadott kártyaazonosító nem található!"?(n(null),window.location.reload()):r==="Network Error"&&(n(null),window.location.href="/")},severity:"error",variant:"filled",sx:{width:"100%"},children:r==="A megadott kártyaazonosító nem található!"?"A megadott kártyaazonosító nem található!":"Hiba történt az adatok betöltése közben!"})})}),t&&e.jsx(g,{theme:u,children:e.jsxs(W,{sx:{bgcolor:"#202938",color:"#d5d6d6",width:{xs:"100%",sm:"70%",md:"60%",lg:"50%",xl:"40%"},marginTop:2},children:[e.jsx($,{avatar:e.jsx(F,{sx:{bgcolor:"#BFA181",color:"#d5d6d6"},"aria-label":"recipe"}),title:e.jsxs(l,{variant:"h5",sx:{color:"#d5d6d6"},children:[t==null?void 0:t.name," #",t==null?void 0:t.customerId]}),subheader:e.jsx(l,{variant:"subtitle1",sx:{color:"#d5d6d6"},children:"Adatok"})}),e.jsx(L,{component:"img",height:"194",image:"/img/profile/profile_temp.png"}),e.jsxs(U,{children:[e.jsx(l,{variant:"h4",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:400,textAlign:"left"},children:t?`Hello ${t==null?void 0:t.name}!`:""}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:300,textAlign:"left"},children:t?`Belépés ideje: ${K(t.createdAt)}`:""}),e.jsx(l,{variant:"h6",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:300,textAlign:"left"},children:t?t.tickets.map(o=>e.jsxs("div",{children:["Jegy: ",o.ticketName]},o.ticketId)):"N/A"}),e.jsxs(l,{variant:"h6",sx:{color:"text.secondary",marginTop:"10px",marginBottom:"10px",textIndent:"20px",fontWeight:300,textAlign:"left"},children:["Kiegészítő jegy(ek):",t?t.admissions.map(o=>e.jsx("li",{children:o.admissionName},o.admissionId)):"N/A"]})]}),e.jsx(J,{})]})})]})}const P=p(localStorage.getItem("token")).role;B.createRoot(document.getElementById("root")).render(e.jsxs(e.Fragment,{children:[e.jsx(M,{role:P}),e.jsx(O,{})]}));
