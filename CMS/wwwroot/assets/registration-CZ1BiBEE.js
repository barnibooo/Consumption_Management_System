import{l as R,j as e,o as T,r as t,e as D,T as h,n as x,f as E}from"./index-DW2RJM_L.js";import{M as H,p as P,N as O}from"./Navbar-BavKYrQN.js";import{c as q}from"./AuthService-CMdpMXi0.js";import{r as V}from"./RefreshService-BElCRExB.js";import{u as N}from"./index-BT0NnjLt.js";import{C as U}from"./Card-B3esABxY.js";import{C as W}from"./CardMedia-Datqsumh.js";import{C as J}from"./CardContent-BSubk8B7.js";import{T as u}from"./TextField-B_SISyHb.js";import{F as $,I as K,S as Q}from"./Select-CssrkscS.js";import{B as Y}from"./Button-L5L-jXUd.js";import{S as b,A as v}from"./Snackbar-BoVZBEip.js";const _=R(e.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd");function G(){const C=T(),a=N(C.breakpoints.down("lg")),[M,l]=t.useState(!1),[I,B]=t.useState([]),[c,w]=t.useState(""),[i,j]=t.useState(null),[n,k]=t.useState(null),[d,S]=t.useState(null),[s,A]=t.useState(null),[y,m]=t.useState(!1),[p,r]=t.useState(null);if(t.useEffect(()=>{(async()=>{const g=localStorage.getItem("token");if(!g){console.error("No token found. Redirecting to login..."),l(!0);return}try{if(!await q()){console.error("Invalid token. Redirecting to login..."),l(!0);return}await V();const L=await x.get("https://localhost:5000/api/Employees/roles",{headers:{Authorization:`Bearer ${g}`}});B(L.data),l(!1)}catch(f){console.error("Error during token validation or data fetching:",f),l(!0)}})()},[]),M)return localStorage.setItem("isUnauthorizedRedirect","true"),setTimeout(()=>{window.location.href="/"},0);const F=async()=>{try{const o={username:i,firstName:n,lastName:d,password:s,role:c};await x.post("https://localhost:5000/api/Auth/register",o,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),m(!0),r(null)}catch(o){if(o.response)switch(o.response.status){case 500:r("Hiba történt a regisztráció során!");break;default:r("Hiba történt a regisztráció során!")}else r("Nem sikerült kapcsolódni a szerverhez!");m(!1)}},z=()=>(i==null?void 0:i.trim())!==""&&(n==null?void 0:n.trim())!==""&&(d==null?void 0:d.trim())!==""&&(s==null?void 0:s.trim())!==""&&c.trim()!=="";return e.jsx(D,{sx:{backgroundColor:"#0F1827",display:"flex",justifyContent:"center",alignItems:"center",width:"100vw",minHeight:"100vh",padding:4,boxSizing:"border-box",overflowY:"auto"},children:e.jsxs(U,{sx:{color:"#d5d6d6",backgroundColor:"#202938",width:{xs:"90%",sm:"70%",md:"55%",lg:"60%"},height:"auto",display:"flex",flexDirection:a?"column":"row"},children:[e.jsx(W,{component:"img",sx:{width:a?"0%":"40%",height:a?"0%":"auto",objectFit:"cover",objectPosition:"left"},image:"/img/main/login_sample.png",alt:"Registration sample"}),e.jsxs(J,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:a?"100%":"50%",flex:1},children:[e.jsx(h,{gutterBottom:!0,variant:"h6",component:"div",sx:{mr:2,display:{md:"flex"},fontWeight:400,color:"#d5d6d6",textDecoration:"none",marginBottom:2,fontSize:{xs:20,sm:20,md:20,lg:22,xl:30}}}),e.jsx(h,{gutterBottom:!0,variant:"h4",component:"div",sx:{mr:2,display:{md:"flex"},fontWeight:300,color:"#d5d6d6",textDecoration:"none",marginBottom:2},children:"Új munkaválláló regisztrációja"}),e.jsx(h,{gutterBottom:!0,variant:"h6",component:"div",sx:{mr:2,display:{md:"flex"},fontWeight:300,color:"#d5d6d6",textDecoration:"none",marginBottom:2}}),e.jsx(u,{sx:{width:"70%",height:"Auto","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#d5d6d6"},"&:hover fieldset":{borderColor:"#d5d6d6"},"&.Mui-focused fieldset":{borderColor:"#BFA181"}},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInputLabel-root.Mui-focused":{color:"#BFA181"},"& .MuiInputBase-input":{color:"#d5d6d6",caretColor:"#d5d6d6"},marginBottom:2},required:!0,id:"outlined-username",label:"Felhasználónév",type:"text",margin:"dense",value:i||"",onChange:o=>j(o.target.value)}),e.jsx(u,{sx:{width:"70%",height:"Auto","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#d5d6d6"},"&:hover fieldset":{borderColor:"#d5d6d6"},"&.Mui-focused fieldset":{borderColor:"#BFA181"}},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInputLabel-root.Mui-focused":{color:"#BFA181"},"& .MuiInputBase-input":{color:"#d5d6d6",caretColor:"#d5d6d6"},marginBottom:2},required:!0,id:"outlined-firstname",label:"Keresztnév",type:"text",margin:"dense",value:n||"",onChange:o=>k(o.target.value)}),e.jsx(u,{sx:{width:"70%",height:"Auto","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#d5d6d6"},"&:hover fieldset":{borderColor:"#d5d6d6"},"&.Mui-focused fieldset":{borderColor:"#BFA181"}},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInputLabel-root.Mui-focused":{color:"#BFA181"},"& .MuiInputBase-input":{color:"#d5d6d6",caretColor:"#d5d6d6"},marginBottom:2},required:!0,id:"outlined-lastname",label:"Vezetéknév",type:"text",margin:"dense",value:d||"",onChange:o=>S(o.target.value)}),e.jsx(u,{sx:{width:"70%",height:"Auto","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#d5d6d6"},"&:hover fieldset":{borderColor:"#d5d6d6"},"&.Mui-focused fieldset":{borderColor:"#BFA181"}},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInputLabel-root.Mui-focused":{color:"#BFA181"},"& .MuiInputBase-input":{color:"#d5d6d6",caretColor:"#d5d6d6"},marginBottom:2},required:!0,id:"outlined-password",label:"Jelszó",type:"password",autoComplete:"new-password",margin:"dense",value:s||"",onChange:o=>A(o.target.value)}),e.jsxs($,{sx:{width:"70%",marginBottom:2,marginTop:1,"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#d5d6d6"},"&:hover fieldset":{borderColor:"#d5d6d6"},"&.Mui-focused fieldset":{borderColor:"#BFA181"}},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInputLabel-root.Mui-focused":{color:"#BFA181"},"& .MuiInputBase-input":{color:"#d5d6d6"},"& .MuiSelect-icon":{color:"#d5d6d6"},"& .Mui-focused .MuiSelect-icon":{color:"#BFA181"}},children:[e.jsx(K,{id:"role-select-label",children:"Munkakör"}),e.jsx(Q,{required:!0,labelId:"role-select-label",id:"role-select",value:c,label:"Munkakör",onChange:o=>w(o.target.value),MenuProps:{PaperProps:{sx:{backgroundColor:"#202938","& .MuiMenuItem-root":{color:"#d5d6d6","&:hover":{backgroundColor:"#37404f"}}}}},children:I.map(o=>e.jsx(H,{value:o,children:o},o))})]}),e.jsx(Y,{sx:{m:2,backgroundColor:"#BFA181",width:"80%","&.Mui-disabled":{backgroundColor:"#9e9386",color:"#d5d6d6"}},variant:"contained",endIcon:e.jsx(_,{}),onClick:F,disabled:!z(),children:"Regisztráció"}),e.jsx(b,{open:y,autoHideDuration:6e3,children:e.jsx(v,{onClose:()=>{m(!1),window.location.reload()},severity:"success",variant:"filled",sx:{width:"100%"},children:"Sikeres regisztráció!"})}),e.jsx(b,{open:!!p,autoHideDuration:6e3,onClose:()=>{r(null),window.location.href="/"},children:e.jsx(v,{onClose:()=>{r(null),window.location.href="/"},severity:"error",variant:"filled",sx:{width:"100%"},children:p})})]})]})})}const X=P(localStorage.getItem("token")).role;E.createRoot(document.getElementById("root")).render(e.jsxs(e.Fragment,{children:[e.jsx(O,{role:X}),e.jsx(G,{})]}));
