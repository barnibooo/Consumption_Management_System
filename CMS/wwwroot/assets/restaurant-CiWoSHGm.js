import{l as n,j as e,r as d,e as r,C as oe,L as ae,T as c,n as f,f as ne}from"./index-DW2RJM_L.js";import{I as h,p as O,N as re}from"./Navbar-BavKYrQN.js";import{S as k,A as le,L as ie,a as de,D as ce}from"./DeleteOutlineOutlined-BKd7d45w.js";import{S as he}from"./Send-COCKoMwb.js";import{c as ue}from"./AuthService-CMdpMXi0.js";import{r as xe}from"./RefreshService-BElCRExB.js";import{S as I,A}from"./Snackbar-BoVZBEip.js";import{C as H}from"./Card-B3esABxY.js";import{C as w}from"./CardHeader-D3kGs5sr.js";import{T as me}from"./TextField-B_SISyHb.js";import{C as B}from"./CardActions-CR4ggJcr.js";import{B as fe}from"./Button-L5L-jXUd.js";import{C as R}from"./CardMedia-Datqsumh.js";import{C as P}from"./CardContent-BSubk8B7.js";import"./Select-CssrkscS.js";const W=n(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline"),U=n(e.jsx("path",{d:"M7 11v2h10v-2zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"RemoveCircleOutline"),pe=n(e.jsx("path",{d:"M19.66 14c-.66 1.92-2.24 3.54-4.4 4.39l-1.26.5V20h-4v-1.11l-1.27-.5c-2.16-.85-3.74-2.47-4.4-4.39zM22 2 4 3.99V12H2c0 3.69 2.47 6.86 6 8.25V22h8v-1.75c3.53-1.39 6-4.56 6-8.25H10.5V8H22V6.5H10.5V4.78L22 3.51zM8 6.5V5.06l1-.11V6.5zm-2.5 0V5.34l1-.11V6.5zM8 12V8h1v4zm-2.5 0V8h1v4z"}),"RamenDiningOutlined"),ge=n(e.jsx("path",{d:"M20.5 10.94c.13-.32.1-.23.15-.39.3-1.21-.34-2.47-1.5-2.93l-2.01-.8c-.46-.18-.95-.21-1.41-.12-.11-.33-.29-.63-.52-.89-.48-.52-1.15-.81-1.85-.81h-2.71c-.71 0-1.38.29-1.85.81-.24.26-.42.56-.53.88-.46-.09-.95-.06-1.41.12l-2.01.8c-1.16.46-1.8 1.72-1.5 2.93l.15.38C1.1 15.55 1 15.55 1 16.38c0 .91.46 1.74 1.24 2.22 1.42.88 2.49.14 4-.61h11.53c1.52.76 1.86 1.01 2.63 1.01 1 0 2.61-.77 2.61-2.61-.01-.85-.13-.88-2.51-5.45m-.38 5.99-1.68-.84 1.08-2.7 1.41 2.71c.28.53-.29 1.09-.81.83m-5.03-.94.62-6.9c.03-.33.37-.54.68-.42l2.01.8c.22.09.34.31.31.54l-2.4 5.98zm-7.41 0-2.4-5.98c-.03-.23.09-.45.31-.54l2.01-.8c.31-.12.65.08.68.42l.62 6.9zm-4.61.11 1.41-2.72 1.08 2.71-1.68.84c-.52.26-1.09-.3-.81-.83m7.08-8.56c-.03-.31.23-.54.5-.54h2.71c.27 0 .53.23.5.54l-.77 8.45h-2.17z"}),"BakeryDiningOutlined"),je=n(e.jsx("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V10h16zm0-13H4V5h16z"}),"CalendarTodayOutlined"),ve=n([e.jsx("circle",{cx:"10.5",cy:"8.5",r:"1.5"},"0"),e.jsx("circle",{cx:"8.5",cy:"13.5",r:"1.5"},"1"),e.jsx("circle",{cx:"15",cy:"15",r:"1"},"2"),e.jsx("path",{d:"M21.95 10.99c-1.79-.03-3.7-1.95-2.68-4.22-2.97 1-5.78-1.59-5.19-4.56C7.11.74 2 6.41 2 12c0 5.52 4.48 10 10 10 5.89 0 10.54-5.08 9.95-11.01M12 20c-4.41 0-8-3.59-8-8 0-3.31 2.73-8.18 8.08-8.02.42 2.54 2.44 4.56 4.99 4.94.07.36.52 2.55 2.92 3.63C19.7 16.86 16.06 20 12 20"},"3")],"CookieOutlined"),Ce=n(e.jsx("path",{d:"m2 19 2 2h16l2-2zm1-1h16.97c.29-3.26-2.28-6-5.48-6-2.35 0-4.35 1.48-5.14 3.55-.41-.23-.87-.38-1.35-.47V9h1.75C10.99 9 12 7.99 12 6.75h9v-1.5h-9C12 4.01 10.99 3 9.75 3H3v1.5h1v.75H3v1.5h1v.75H3V9h1v7.39c-.44.46-.78 1-1 1.61m11.5-4c.99 0 1.91.4 2.58 1.14.24.26.44.55.58.86h-6.32c.58-1.21 1.81-2 3.16-2M8 4.5h2v.75H8zm0 2.25h2v.75H8zM5.5 4.5h1v.75h-1zm0 2.25h1v.75h-1zM5.5 9h1v6.06c-.35.06-.68.17-1 .3z"}),"DinnerDiningOutlined"),be=n(e.jsx("path",{d:"M2 19h18v2H2zM20 3H4v10c0 2.21 1.79 4 4 4h6c2.21 0 4-1.79 4-4v-3h2c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2m-4 10c0 1.1-.9 2-2 2H8c-1.1 0-2-.9-2-2V5h3v1.4L7.19 7.85c-.12.09-.19.24-.19.39v4.26c0 .28.22.5.5.5h4c.28 0 .5-.22.5-.5V8.24c0-.15-.07-.3-.19-.39L10 6.4V5h6zM9.5 7.28l1.5 1.2V12H8V8.48zM20 8h-2V5h2z"}),"EmojiFoodBeverageOutlined"),ye=n(e.jsx("path",{d:"M1 21.98c0 .56.45 1.01 1.01 1.01H15c.56 0 1.01-.45 1.01-1.01V21H1zM8.5 8.99C4.75 8.99 1 11 1 15h15c0-4-3.75-6.01-7.5-6.01M3.62 13c1.11-1.55 3.47-2.01 4.88-2.01s3.77.46 4.88 2.01zM1 17h15v2H1zM18 5V1h-2v4h-5l.23 2h9.56l-1.4 14H18v2h1.72c.84 0 1.53-.65 1.63-1.47L23 5z"}),"FastfoodOutlined"),ze=n(e.jsx("path",{d:"M14.77 9 12 12.11 9.23 9zM21 3H3v2l8 9v5H6v2h12v-2h-5v-5l8-9zM7.43 7 5.66 5h12.69l-1.78 2z"}),"LocalBarOutlined"),Se=n(e.jsx("path",{d:"M12 2C8.43 2 5.23 3.54 3.01 6L12 22l8.99-16C18.78 3.55 15.57 2 12 2m0 15.92L5.51 6.36C7.32 4.85 9.62 4 12 4s4.68.85 6.49 2.36zM9 5.5c-.83 0-1.5.67-1.5 1.5S8.17 8.5 9 8.5s1.5-.67 1.5-1.5S9.82 5.5 9 5.5m1.5 7.5c0 .83.67 1.5 1.5 1.5.82 0 1.5-.67 1.5-1.5s-.68-1.5-1.5-1.5-1.5.67-1.5 1.5"}),"LocalPizzaOutlined"),Me=n(e.jsx("path",{d:"M2 19c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-3H2zm2-1h16v1H4zm14.66-6.5c-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1v2c1.9 0 2.17-1 3.35-1 1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.4.98 3.32 1l-.01-1.98c-1.61-.33-1.62-1.02-3.33-1.02M22 9c.02-4-4.28-6-10-6C6.29 3 2 5 2 9v1h20zM4.18 8C5.01 5.81 8.61 5 12 5c3.31 0 5.93.73 7.19 1.99.3.31.52.64.65 1.01z"}),"LunchDiningOutlined"),ke=n(e.jsx("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz"),l={fontSize:35,color:"#d5d6d6","&:hover":{color:"#BFA181"}},D={Leves:e.jsx(pe,{sx:l}),Előétel:e.jsx(ge,{sx:l}),Főétel:e.jsx(Ce,{sx:l}),Hamburger:e.jsx(Me,{sx:l}),Pizza:e.jsx(Se,{sx:l}),Desszert:e.jsx(ve,{sx:l}),Menü:e.jsx(ye,{sx:l}),Ital:e.jsx(ze,{sx:l}),Kávé:e.jsx(be,{sx:l}),Egyéb:e.jsx(ke,{sx:l}),"Napi ajánlat":e.jsx(je,{sx:l})},Ie=()=>{const[u,$]=d.useState([]),[G,V]=d.useState(!0),[b,K]=d.useState(null),[x,p]=d.useState([]),[F,g]=d.useState(null),[j,y]=d.useState(null),[z,S]=d.useState(null),[Y,v]=d.useState(!1),[J,C]=d.useState(!1),M=t=>{K(t),t==="Napi ajánlat"&&f.get("https://localhost:5000/api/DailySpecials",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(o=>{const s=o.data,i=u.filter(a=>[s[0].soupName,s[0].appetizerName,s[0].mainCourseName,s[0].hamburgerName,s[0].pizzaName,s[0].dessertName,s[0].drinkName,s[0].coffeeName].includes(a.name));S(i)}).catch(o=>{console.error("Hiba történt a napi ajánlatok betöltése közben:",o),S([])})},L=t=>{p(o=>o.find(i=>i.itemId===t.itemId)?o.map(i=>i.itemId===t.itemId?{...i,quantity:(i.quantity||0)+1}:i):[...o,{...t,quantity:1}])},E=t=>{p(o=>o.map(s=>s.itemId===t.itemId?{...s,quantity:(s.quantity||0)-1}:s).filter(s=>s.quantity>0))},Q=t=>{p(o=>o.filter(s=>s.itemId!==t.itemId))},X=()=>x.reduce((t,o)=>t+o.price*o.quantity,0),[Z,m]=d.useState(!1);if(d.useEffect(()=>{(async()=>{const o=localStorage.getItem("token");if(!o){console.error("No token found. Redirecting to login..."),m(!0);return}try{const s=O(o);if(!s||s.role!=="Admin"&&s.role!=="RestaurantAssistant"){console.error("Unauthorized access: Admin or RestaurantAssistant role required"),m(!0);return}if(!await ue()){console.error("Invalid token. Redirecting to login..."),m(!0);return}await xe();const a=localStorage.getItem("token");if(!a)throw new Error("Token refresh failed");const T=await f.get("https://localhost:5000/api/MenuItems",{headers:{Authorization:`Bearer ${a}`}});Array.isArray(T.data)&&$(T.data);const q=await f.get("https://localhost:5000/api/DailySpecials",{headers:{Authorization:`Bearer ${a}`}});q.data&&S(q.data),m(!1),V(!1)}catch(s){console.error("Error during token validation or data fetching:",s),m(!0),V(!1)}})()},[]),Z)return localStorage.setItem("isUnauthorizedRedirect","true"),window.location.href="/",null;const _=()=>{!j||x.length===0||f.get("https://localhost:5000/api/Cards/GetCustomerIdByCardId/"+j,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(t=>{if(isNaN(t.data))C(!0),y(""),setTimeout(()=>C(!1),6e3);else{const o=localStorage.getItem("token");let s=null;o&&(s=O(o));const i={customerId:t.data,employeeId:(s==null?void 0:s.EmployeeId)||"",menuItems:x.map(a=>({menuItemId:a.itemId,quantity:a.quantity}))};f.post("https://localhost:5000/api/Orders",i,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{console.log(a.data),a.status===201&&(v(!0),p([]),y(""),setTimeout(()=>{v(!1)},6e3))}).catch(a=>{g(a)})}}).catch(t=>{console.error("Hiba történt az adatok betöltése közben:",t),g(t)})};if(G)return e.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(oe,{size:120,sx:{color:"#bfa181"}})});if(F)return e.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(I,{open:!!F,autoHideDuration:6e3,onClose:()=>{g(null),window.location.href="/"},children:e.jsx(A,{onClose:()=>{g(null),window.location.href="/"},severity:"error",variant:"filled",sx:{width:"100%"},children:"Hiba történt az adatok betöltése közben!"})})});var ee=u.length;const N=(()=>{const t=[];for(let o=0;o<ee;o++){const s=u[o].category;t.includes(s)||t.push(s)}return t})().filter(t=>t!=="Egyéb");N.unshift("Napi ajánlat");const te=u.some(t=>t.category==="Egyéb"),se=b?u.filter(t=>t.category===b):u;return e.jsx(e.Fragment,{children:e.jsxs(r,{display:"flex",height:"calc(100vh - 64px)",flexDirection:{xs:"column",md:"row"},children:[e.jsx(r,{sx:{display:{xs:"none",sm:"none",md:"none",lg:"flex"},flexDirection:{xs:"column",md:"row"},justifyContent:{xs:"center",md:"flex-start"},alignItems:"flex-start",p:2,width:{xs:"90%",md:"auto"},minWidth:{md:50},mb:{xs:2,md:0},m:2,height:"90%",backgroundColor:"#202938"},children:e.jsxs(k,{direction:{xs:"row",md:"column"},spacing:2,children:[e.jsx(h,{onClick:()=>M(null),children:e.jsx(le,{sx:{fontSize:35,color:"#d5d6d6","&:hover":{color:"#BFA181"},"&:active":{color:"#BFA181"}}})}),N.map(t=>e.jsx(h,{onClick:()=>M(t),sx:{iconStyle:l},children:D[t]},t)),e.jsx(h,{onClick:()=>M("Egyéb"),disabled:!te,sx:{fontSize:35,color:"#d5d6d6","&:hover":{color:"#BFA181"},"&:active":{color:"#BFA181"}},children:D.Egyéb})]})}),e.jsx(r,{mb:{xs:2,md:3},width:{xs:"90%",md:"70%",lg:"40%",xl:"30%"},display:"flex",justifyContent:{xs:"center",md:"flex-start"},sx:{height:"93%",p:2},children:e.jsxs(H,{sx:{width:{xs:"100%",md:"100%"},height:"100%",backgroundColor:"#202938",display:"flex",flexDirection:"column"},children:[e.jsx(w,{title:"Rendelés",subheader:e.jsxs(e.Fragment,{children:[`Összesen: ${X()} Ft`,e.jsx(r,{sx:{display:"flex",justifyContent:"center",marginTop:2},children:e.jsx(me,{required:!0,id:"card-id-input",label:"Kártyazonosító",variant:"standard",value:j||"",onChange:t=>y(t.target.value),sx:{width:"80%","& .MuiInputBase-root":{color:"#d5d6d6"},"& .MuiInputLabel-root":{color:"#d5d6d6"},"& .MuiInput-underline:before":{borderBottomColor:"#d5d6d6"},"& .MuiInput-underline:hover:before":{borderBottomColor:"#d5d6d6"},"& .MuiInput-underline:after":{borderBottomColor:"#d5d6d6"},"& .Mui-focused .MuiInputLabel-root":{color:"#d5d6d6 !important"},"& .Mui-focused .MuiInput-underline:before":{borderBottomColor:"#d5d6d6 !important"},"& .Mui-focused .MuiInput-underline:after":{borderBottomColor:"#d5d6d6 !important"}}})})]}),sx:{"& .MuiCardHeader-subheader":{color:"#d5d6d6"},"& .MuiCardHeader-title":{color:"#e7e6dd"}}}),e.jsx(r,{sx:{flex:1,overflowY:"auto",maxHeight:"550px",padding:1},children:e.jsx(ae,{dense:!0,children:x.map((t,o)=>e.jsxs(ie,{secondaryAction:e.jsx(h,{edge:"end","aria-label":"delete",onClick:()=>Q(t),children:e.jsx(ce,{sx:{fontSize:35,color:"#d5d6d6","&:hover":{color:"#BFA181"}}})}),children:[e.jsx(de,{children:D[t.category]}),e.jsxs(c,{variant:"body2",color:"#e7e6dd",fontSize:16,children:[t.name," x",t.quantity," ",e.jsx("br",{})," ",t.price*t.quantity," Ft"]})]},o))})}),e.jsxs(B,{disableSpacing:!0,sx:{mt:"auto",justifyContent:"center",paddingBottom:2},children:[e.jsx(fe,{variant:"contained",endIcon:e.jsx(he,{}),sx:{m:2,backgroundColor:"#BFA181",width:"80%","&.Mui-disabled":{backgroundColor:"#9e9386",color:"#d5d6d6"}},onClick:_,disabled:!j||x.length===0,children:"Rendelés leadása"}),e.jsx(I,{open:Y,autoHideDuration:6e3,onClose:()=>v(!1),children:e.jsx(A,{onClose:()=>v(!1),severity:"success",variant:"filled",sx:{width:"100%"},children:"Sikeres rendelés leadás!"})}),e.jsx(I,{open:J,autoHideDuration:6e3,onClose:()=>C(!1),children:e.jsx(A,{onClose:()=>C(!1),severity:"error",variant:"filled",sx:{width:"100%"},children:"A megadott kártyaszám nem létezik!"})})]})]})}),e.jsx(r,{display:"flex",flexDirection:"column",flexGrow:1,ml:{md:3},width:"100%",children:b==="Napi ajánlat"?z&&z.length>0?e.jsx(r,{sx:{height:"100%",overflowY:"scroll"},children:e.jsx(k,{direction:"row",flexWrap:"wrap",gap:2,justifyContent:{xs:"center",sm:"flex-start"},margin:2,children:z.map(t=>e.jsxs(H,{sx:{width:{xs:"100%",sm:"45%",md:"90%",lg:"45%",xl:"30%"},background:"#202938",color:"#d5d6d6",display:"flex",flexDirection:"column"},children:[e.jsx(w,{title:t.name,subheader:t.category,sx:{"& .MuiCardHeader-subheader":{color:"#d5d6d6"}}}),e.jsx(R,{component:"img",height:"200",image:t.imagePath,alt:"Kép"}),e.jsxs(P,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[e.jsx(c,{mb:2,children:t.description}),e.jsxs(r,{sx:{mt:"auto"},children:[e.jsx(c,{fontWeight:"bold",children:t.isAvailable?"Elérhető":"Nem elérhető"}),e.jsxs(c,{fontWeight:"bold",children:[t.price," Ft"]})]})]}),e.jsxs(B,{disableSpacing:!0,sx:{mt:"auto",justifyContent:"flex-start"},children:[e.jsx(h,{onClick:()=>L(t),disabled:t.isAvailable===!1,children:e.jsx(W,{sx:{fontSize:35,color:t.isAvailable===!1?"#6d737d":"#d5d6d6","&:hover":{color:t.isAvailable===!1?"#6d737d":"#BFA181"}}})}),e.jsx(h,{onClick:()=>E(t),disabled:t.isAvailable===!1,children:e.jsx(U,{sx:{fontSize:35,color:t.isAvailable===!1?"#6d737d":"#d5d6d6","&:hover":{color:t.isAvailable===!1?"#6d737d":"#BFA181"}}})})]})]},t.itemId))})}):e.jsx(c,{variant:"h6",color:"#d5d6d6",textAlign:"center",children:"Nincs elérhető napi ajánlat."}):e.jsx(r,{sx:{height:"100%",overflowY:"scroll"},children:e.jsx(k,{direction:"row",flexWrap:"wrap",gap:2,justifyContent:{xs:"center",sm:"flex-start"},margin:2,children:se.map(t=>e.jsxs(H,{sx:{width:{xs:"100%",sm:"45%",md:"90%",lg:"45%",xl:"30%"},background:"#202938",color:"#d5d6d6",display:"flex",flexDirection:"column"},children:[e.jsx(w,{title:t.name,subheader:t.category,sx:{"& .MuiCardHeader-subheader":{color:"#d5d6d6"}}}),e.jsx(R,{component:"img",height:"200",image:t.imagePath,alt:"Kép"}),e.jsxs(P,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[e.jsx(c,{mb:2,children:t.description}),e.jsxs(r,{sx:{mt:"auto"},children:[e.jsx(c,{fontWeight:"bold",children:t.isAvailable?"Elérhető":"Nem elérhető"}),e.jsxs(c,{fontWeight:"bold",children:[t.price," Ft"]})]})]}),e.jsxs(B,{disableSpacing:!0,sx:{mt:"auto",justifyContent:"flex-start"},children:[e.jsx(h,{onClick:()=>L(t),disabled:t.isAvailable===!1,children:e.jsx(W,{sx:{fontSize:35,color:t.isAvailable===!1?"#6d737d":"#d5d6d6","&:hover":{color:t.isAvailable===!1?"#6d737d":"#BFA181"}}})}),e.jsx(h,{onClick:()=>E(t),disabled:t.isAvailable===!1,children:e.jsx(U,{sx:{fontSize:35,color:t.isAvailable===!1?"#6d737d":"#d5d6d6","&:hover":{color:t.isAvailable===!1?"#6d737d":"#BFA181"}}})})]})]},t.itemId))})})})]})})},Ae=O(localStorage.getItem("token")).role;ne.createRoot(document.getElementById("root")).render(e.jsxs(e.Fragment,{children:[e.jsx(re,{role:Ae}),e.jsx(Ie,{})]}));
